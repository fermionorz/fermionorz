
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://fermionorz.github.io/wiki/%E8%93%9D%E9%98%9F/HackTheBox-Sherlocks/DFIR/Medium%29%20TickTock/">
      
      
        <link rel="prev" href="../Easy%29%20Logjammer/">
      
      
        <link rel="next" href="../Very%20Easy%29%20BFT/">
      
      
      <link rel="icon" href="https://avatars.githubusercontent.com/u/112745175?size=32">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Medium) TickTock - Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../.." title="Wiki" class="md-header__button md-logo" aria-label="Wiki" data-md-component="logo">
      
  <img src="https://avatars.githubusercontent.com/u/112745175?size=64" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Medium) TickTock
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="purple" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://fermionorz.github.io/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    回到主页
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  关于

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E5%8F%96%E8%AF%81/" class="md-tabs__link">
          
  
    
  
  取证

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E5%BC%80%E5%8F%91/" class="md-tabs__link">
          
  
    
  
  开发

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E6%95%B0%E5%AD%A6/" class="md-tabs__link">
          
  
    
  
  数学

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E6%B8%B8%E6%88%8F/" class="md-tabs__link">
          
  
    
  
  游戏

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E7%8E%84%E5%AD%A6/" class="md-tabs__link">
          
  
    
  
  玄学

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E7%A1%AC%E4%BB%B6/" class="md-tabs__link">
          
  
    
  
  硬件

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E7%BA%A2%E9%98%9F/" class="md-tabs__link">
          
  
    
  
  红队

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
    
  
  蓝队

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../%E9%80%86%E5%90%91/" class="md-tabs__link">
          
  
    
  
  逆向

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Wiki" class="md-nav__button md-logo" aria-label="Wiki" data-md-component="logo">
      
  <img src="https://avatars.githubusercontent.com/u/112745175?size=64" alt="logo">

    </a>
    Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://fermionorz.github.io/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    回到主页
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关于
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E5%8F%96%E8%AF%81/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    取证
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E5%BC%80%E5%8F%91/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    开发
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E6%95%B0%E5%AD%A6/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    数学
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E6%B8%B8%E6%88%8F/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    游戏
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E7%8E%84%E5%AD%A6/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    玄学
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E7%A1%AC%E4%BB%B6/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    硬件
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E7%BA%A2%E9%98%9F/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    红队
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    蓝队
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            蓝队
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HackTheBox Sherlocks
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            HackTheBox Sherlocks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Campaign/Easy%29%20OpTinselTrace-1/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Campaign
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_9_2_3" id="__nav_9_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFIR
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9_2_3">
            <span class="md-nav__icon md-icon"></span>
            DFIR
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Easy%29%20Logjammer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easy) Logjammer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Medium) TickTock
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Medium) TickTock
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registry-hive" class="md-nav__link">
    <span class="md-ellipsis">
      Registry hive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mft" class="md-nav__link">
    <span class="md-ellipsis">
      MFT 文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-evtx" class="md-nav__link">
    <span class="md-ellipsis">
      Windows 事件日志文件 .evtx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log" class="md-nav__link">
    <span class="md-ellipsis">
      日志文件 .log
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile-history-data-appcommandbrowser" class="md-nav__link">
    <span class="md-ellipsis">
      Profile History Data (APP、Command、Browser)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefetch" class="md-nav__link">
    <span class="md-ellipsis">
      prefetch 预取目录
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-what-was-the-name-of-the-executable-that-was-uploaded-as-a-c2-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1 - What was the name of the executable that was uploaded as a C2 Agent?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-what-was-the-session-id-for-in-the-initial-access" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2 - What was the session id for in the initial access?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-the-attacker-attempted-to-set-a-bitlocker-password-on-the-c-drive-what-was-the-password" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3 - The attacker attempted to set a bitlocker password on the C: drive what was the password?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-what-name-was-used-by-the-attacker" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4 - What name was used by the attacker?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-what-ip-address-did-the-c2-connect-back-to" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5 - What IP address did the C2 connect back to?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-6-what-category-did-windows-defender-give-to-the-c2-binary-file" class="md-nav__link">
    <span class="md-ellipsis">
      Task 6 - What category did Windows Defender give to the C2 binary file?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-7-what-was-the-filename-of-the-powershell-script-the-attackers-used-to-manipulate-time" class="md-nav__link">
    <span class="md-ellipsis">
      Task 7 - What was the filename of the powershell script the attackers used to manipulate time?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-8-what-time-did-the-initial-access-connection-start" class="md-nav__link">
    <span class="md-ellipsis">
      Task 8 - What time did the initial access connection start?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-9-what-is-the-sha1-and-sha2-sum-of-the-malicious-binary" class="md-nav__link">
    <span class="md-ellipsis">
      Task 9 - What is the SHA1 and SHA2 sum of the malicious binary?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-10-how-many-times-did-the-powershell-script-change-the-time-on-the-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Task 10 - How many times did the powershell script change the time on the machine?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-11-what-is-the-sid-of-the-victim-user" class="md-nav__link">
    <span class="md-ellipsis">
      Task 11 - What is the SID of the victim user?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Very%20Easy%29%20BFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Very Easy) BFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Very%20Easy%29%20Brutus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Very Easy) Brutus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Very%20Easy%29%20Campfire-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Very Easy) Campfire 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Very%20Easy%29%20Campfire-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Very Easy) Campfire 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Very%20Easy%29%20Fragility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Very Easy) Fragility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Very%20Easy%29%20Unit42/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Very Easy) Unit42
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../Malware%20Analysis/Insane%29%20Safecracker%20%C3%97/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Malware Analysis
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../%E9%80%86%E5%90%91/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    逆向
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#registry-hive" class="md-nav__link">
    <span class="md-ellipsis">
      Registry hive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mft" class="md-nav__link">
    <span class="md-ellipsis">
      MFT 文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#windows-evtx" class="md-nav__link">
    <span class="md-ellipsis">
      Windows 事件日志文件 .evtx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log" class="md-nav__link">
    <span class="md-ellipsis">
      日志文件 .log
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile-history-data-appcommandbrowser" class="md-nav__link">
    <span class="md-ellipsis">
      Profile History Data (APP、Command、Browser)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefetch" class="md-nav__link">
    <span class="md-ellipsis">
      prefetch 预取目录
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-what-was-the-name-of-the-executable-that-was-uploaded-as-a-c2-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1 - What was the name of the executable that was uploaded as a C2 Agent?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-what-was-the-session-id-for-in-the-initial-access" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2 - What was the session id for in the initial access?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-the-attacker-attempted-to-set-a-bitlocker-password-on-the-c-drive-what-was-the-password" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3 - The attacker attempted to set a bitlocker password on the C: drive what was the password?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-what-name-was-used-by-the-attacker" class="md-nav__link">
    <span class="md-ellipsis">
      Task 4 - What name was used by the attacker?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-what-ip-address-did-the-c2-connect-back-to" class="md-nav__link">
    <span class="md-ellipsis">
      Task 5 - What IP address did the C2 connect back to?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-6-what-category-did-windows-defender-give-to-the-c2-binary-file" class="md-nav__link">
    <span class="md-ellipsis">
      Task 6 - What category did Windows Defender give to the C2 binary file?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-7-what-was-the-filename-of-the-powershell-script-the-attackers-used-to-manipulate-time" class="md-nav__link">
    <span class="md-ellipsis">
      Task 7 - What was the filename of the powershell script the attackers used to manipulate time?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-8-what-time-did-the-initial-access-connection-start" class="md-nav__link">
    <span class="md-ellipsis">
      Task 8 - What time did the initial access connection start?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-9-what-is-the-sha1-and-sha2-sum-of-the-malicious-binary" class="md-nav__link">
    <span class="md-ellipsis">
      Task 9 - What is the SHA1 and SHA2 sum of the malicious binary?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-10-how-many-times-did-the-powershell-script-change-the-time-on-the-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Task 10 - How many times did the powershell script change the time on the machine?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-11-what-is-the-sid-of-the-victim-user" class="md-nav__link">
    <span class="md-ellipsis">
      Task 11 - What is the SID of the victim user?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Medium) TickTock</h1>

<blockquote>
<p>Gladys is a new joiner in the company, she has recieved an email informing her that the IT department is due to do some work on her PC, she is guided to call the IT team where they will inform her on how to allow them remote access. The IT team however are actually a group of hackers that are attempting to attack Forela.</p>
</blockquote>
<h2 id="task">Task</h2>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 1 - What was the name of the executable that was uploaded as a C2 Agent?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 2 - What was the session id for in the initial access?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 3 - The attacker attempted to set a bitlocker password on the C: drive what was the password?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 4 - What name was used by the attacker?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 5 - What IP address did the C2 connect back to?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 6 - What category did Windows Defender give to the C2 binary file?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 7 - What was the filename of the powershell script the attackers used to manipulate time?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 8 - What time did the initial access connection start?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 9 - What is the SHA1 and SHA2 sum of the malicious binary?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 10 - How many times did the powershell script change the time on the machine?</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Task 11 - What is the SID of the victim user?</li>
</ul>
<h2 id="data">Data</h2>
<blockquote>
<p>此题目为 Windows 取证，可以从以下部分入手</p>
</blockquote>
<ul>
<li>Check list</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Registry hive
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>MFT
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Windows Event logs
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>Other Logs
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>Profile History Data (APP、Command、Browser)
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>prefetch
</span></code></pre></div>
<p>解压后得到一个目录，内有以下文件</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231220115059.png" /></p>
<p>三个文本文件记录了<code>C</code> 目录的结构信息。</p>
<h3 id="registry-hive">Registry hive</h3>
<blockquote>
<p>Collection/C/Windows/System32/config    # 先把 NTLM dump下来</p>
</blockquote>
<p><code>impacket-secretsdump -sam SAM -system SYSTEM -security SECURITY local</code></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Impacket v0.11.0 - Copyright 2023 Fortra
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>[*] Target system bootKey: 0x81291263122d9530f0893f526c3e4d38
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>forela-wkstn-gold:1001:aad3b435b51404eeaad3b435b51404ee:e19ccf75ee54e06b06a5907af13cef42:::
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>gladys:1003:aad3b435b51404eeaad3b435b51404ee:217e50203a5aba59cefa863c724bf61b:::
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>[*] Dumping cached domain logon information (domain/username:hash)
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>[*] Dumping LSA Secrets
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>[*] DPAPI_SYSTEM 
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>dpapi_machinekey:0x75252b223522bbd9ca9695571293980e45d804e9
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>dpapi_userkey:0xe74459cd65b97108dd5bd7a8410a29b4e4e41980
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>[*] Cleaning up...
</span></code></pre></div>
<h3 id="mft">MFT 文件</h3>
<blockquote>
<p>https://ericzimmerman.github.io/
MFTECmd.exe
MFTExplorer.exe</p>
</blockquote>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">PS</span><span class="p">&gt;</span> <span class="n">MFTEcmd</span><span class="p">.</span><span class="n">exe</span> <span class="o">-f</span> <span class="s2">&quot;.\Collection\C\$MFT&quot;</span> <span class="p">-</span><span class="n">-json</span> <span class="n">export</span><span class="p">\</span><span class="n">mft</span><span class="p">\</span> <span class="p">-</span><span class="n">-csv</span> <span class="n">export</span><span class="p">\</span><span class="n">mft</span><span class="p">\</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">MFTECmd</span> <span class="n">version</span> <span class="n">1</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">1</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">Author</span><span class="p">:</span> <span class="n">Eric</span> <span class="n">Zimmerman</span> <span class="p">(</span><span class="n">saericzimmerman</span><span class="nv">@gmail</span><span class="p">.</span><span class="n">com</span><span class="p">)</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">https</span><span class="p">://</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="p">/</span><span class="n">EricZimmerman</span><span class="p">/</span><span class="n">MFTECmd</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">Command</span> <span class="n">line</span><span class="p">:</span> <span class="o">-f</span> <span class="p">.\</span><span class="n">Collection</span><span class="p">\</span><span class="n">C</span><span class="p">\</span><span class="nv">$MFT</span> <span class="p">-</span><span class="n">-json</span> <span class="n">export</span><span class="p">\</span><span class="n">mft</span><span class="p">\</span> <span class="p">-</span><span class="n">-csv</span> <span class="n">export</span><span class="p">\</span><span class="n">mft</span><span class="p">\</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="n">File</span> <span class="n">type</span><span class="p">:</span> <span class="n">Mft</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="n">Processed</span> <span class="p">.\</span><span class="n">Collection</span><span class="p">\</span><span class="n">C</span><span class="p">\</span><span class="nv">$MFT</span> <span class="k">in</span> <span class="n">9</span><span class="p">.</span><span class="n">3341</span> <span class="n">seconds</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="p">.\</span><span class="n">Collection</span><span class="p">\</span><span class="n">C</span><span class="p">\</span><span class="nv">$MFT</span><span class="p">:</span> <span class="n">FILE</span> <span class="n">records</span> <span class="n">found</span><span class="p">:</span> <span class="n">120</span><span class="p">,</span><span class="n">652</span> <span class="p">(</span><span class="n">Free</span> <span class="n">records</span><span class="p">:</span> <span class="n">11</span><span class="p">,</span><span class="n">126</span><span class="p">)</span> <span class="n">File</span> <span class="n">size</span><span class="p">:</span> <span class="n">128</span><span class="p">.</span><span class="n">8MB</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>        <span class="n">CSV</span> <span class="n">output</span> <span class="n">will</span> <span class="n">be</span> <span class="n">saved</span> <span class="n">to</span> <span class="n">export</span><span class="p">\</span><span class="n">mft</span><span class="p">\</span><span class="n">20231222084212_MFTECmd_</span><span class="nv">$MFT_Output</span><span class="p">.</span><span class="n">csv</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>        <span class="n">JSON</span> <span class="n">output</span> <span class="n">will</span> <span class="n">be</span> <span class="n">saved</span> <span class="n">to</span> <span class="n">export</span><span class="p">\</span><span class="n">mft</span><span class="p">\</span><span class="n">20231222084212_MFTECmd_</span><span class="nv">$MFT_Output</span><span class="p">.</span><span class="n">json</span>
</span></code></pre></div>
<p>得到 csv 和 json 文件</p>
<h3 id="windows-evtx">Windows 事件日志文件 .evtx</h3>
<blockquote>
<p>https://github.com/WithSecureLabs/chainsaw</p>
</blockquote>
<ul>
<li>导出</li>
</ul>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>find<span class="w"> </span>.<span class="w"> </span>-name<span class="w"> </span><span class="s1">&#39;*.evtx&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>chainsaw<span class="w"> </span>dump<span class="w"> </span><span class="nv">$line</span><span class="w"> </span>--json<span class="w"> </span>--output<span class="w"> </span>./export/evtx/<span class="k">$(</span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">$line</span>.json<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span>-F<span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="s1">&#39;{print $NF}&#39;</span><span class="k">)</span><span class="w"> </span><span class="p">;</span><span class="k">done</span>
</span></code></pre></div>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>chainsaw<span class="w"> </span>hunt<span class="w"> </span>--skip-errors<span class="w"> </span>-s<span class="w"> </span>~/.ztm/Forensics/chainsaw/sigma<span class="w"> </span>-r<span class="w"> </span>~/.ztm/Forensics/chainsaw/rules<span class="w"> </span>-m<span class="w"> </span>~/.ztm/Forensics/chainsaw/mappings/sigma-event-logs-all.yml<span class="w"> </span>-o<span class="w"> </span>./export/evtx/chainsaw_hunt.log<span class="w"> </span>Collection/C/Windows/System32/winevt/logs/
</span></code></pre></div>
<h3 id="log">日志文件 .log</h3>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>find<span class="w"> </span>.<span class="w"> </span>-name<span class="w"> </span><span class="s1">&#39;*.log&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>cp<span class="w"> </span><span class="nv">$line</span><span class="w"> </span>export/logs/<span class="p">;</span><span class="w"> </span><span class="k">done</span>
</span></code></pre></div>
<h3 id="profile-history-data-appcommandbrowser">Profile History Data (APP、Command、Browser)</h3>
<blockquote>
<p>Collection/C/Users/gladys/AppData/
Collection/C/Users/gladys/AppData/Roaming/Microsoft/Windows/PowerShell/PSReadline/ConsoleHost_history.txt</p>
</blockquote>
<h3 id="prefetch">prefetch 预取目录</h3>
<blockquote>
<p>Collection/C/Windows/prefetch</p>
</blockquote>
<p>现在收集已有的信息</p>
<h2 id="task-1-what-was-the-name-of-the-executable-that-was-uploaded-as-a-c2-agent">Task 1 - What was the name of the executable that was uploaded as a C2 Agent?</h2>
<blockquote>
<p>merlin.exe</p>
</blockquote>
<p>首先查看 gladys 主目录，并没有发现什么东西</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231220124539.png" /></p>
<p>想到后门可能会被 Windows defender 杀掉，查看 WDF 日志</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231220124653.png" /></p>
<h2 id="task-2-what-was-the-session-id-for-in-the-initial-access">Task 2 - What was the session id for in the initial access?</h2>
<blockquote>
<p>-2102926010</p>
</blockquote>
<p>一时猜不到是什么会话 id，但应该和应用相关。在日志文件中发现 TeamView</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227085947.png" /></p>
<p>查看日志，发现 Session id</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231220125623.png" /></p>
<h2 id="task-3-the-attacker-attempted-to-set-a-bitlocker-password-on-the-c-drive-what-was-the-password">Task 3 - The attacker attempted to set a bitlocker password on the <code>C:</code> drive what was the password?</h2>
<blockquote>
<p>reallylongpassword</p>
</blockquote>
<p>攻击者试图设置 bitlocker 的行为会被 Sysmon 捕获，查看 Sysmon 事件日志
<code>cat Microsoft-Windows-Sysmon%4Operational.evtx.log | grep '"CommandLine'</code>
<img alt="" src="../../../../assets/Pasted%20image%2020231227113610.png" />
Base64 解码 <code>echo ... | base64 -d</code>
<img alt="" src="../../../../assets/Pasted%20image%2020231227113645.png" /></p>
<h2 id="task-4-what-name-was-used-by-the-attacker">Task 4 - What name was used by the attacker?</h2>
<blockquote>
<p>fritjof olfasson</p>
</blockquote>
<p>查找 TeamView 日志，发现新的接入者
<img alt="" src="../../../../assets/Pasted%20image%2020231227114331.png" /></p>
<h2 id="task-5-what-ip-address-did-the-c2-connect-back-to">Task 5 - What IP address did the C2 connect back to?</h2>
<blockquote>
<p>52.56.142.81</p>
</blockquote>
<p>C2 的回连 IP 可以分析 C2 文件，或者通过系统 Sysmon 抓取。
在 Event Logs 中发现 <code>Collection/C/Windows/System32/winevt/logs/Microsoft-Windows-Sysmon%4Operational.evtx</code>
查看 chainsaw 转储后的内容</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227101712.png" /></p>
<h2 id="task-6-what-category-did-windows-defender-give-to-the-c2-binary-file">Task 6 - What category did Windows Defender give to the C2 binary file?</h2>
<blockquote>
<p>VirTool:Win32/Myrddin.D</p>
</blockquote>
<p>可以在 Windows Defender 日志中看到</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227095849.png" /></p>
<h2 id="task-7-what-was-the-filename-of-the-powershell-script-the-attackers-used-to-manipulate-time">Task 7 - What was the filename of the powershell script the attackers used to manipulate time?</h2>
<blockquote>
<p>Invoke-TimeWizard.ps1</p>
</blockquote>
<p>Powershell 脚本首先想到 Powershell 命令历史</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227100228.png" /></p>
<h2 id="task-8-what-time-did-the-initial-access-connection-start">Task 8 - What time did the initial access connection start?</h2>
<blockquote>
<p>2023/05/04 11:35:27</p>
</blockquote>
<p>可以在 TeamView 日志中看到</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231228083157.png" /></p>
<h2 id="task-9-what-is-the-sha1-and-sha2-sum-of-the-malicious-binary">Task 9 - What is the SHA1 and SHA2 sum of the malicious binary?</h2>
<blockquote>
<p>ac688f1ba6d4b23899750b86521331d7f7ccfb69:42ec59f760d8b6a50bbc7187829f62c3b6b8e1b841164e7185f497eb7f3b4db9</p>
</blockquote>
<p>Windows Defender 日志中可以看到 merlin.exe 部分会标记恶意程序的 SHA</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227102424.png" /></p>
<h2 id="task-10-how-many-times-did-the-powershell-script-change-the-time-on-the-machine">Task 10 - How many times did the powershell script change the time on the machine?</h2>
<blockquote>
<p>2371</p>
</blockquote>
<p>攻击者使用 Powershell 脚本修改事件，因此首先查看安全事件中的 4616 事件
<code>cat Security.evtx.log | grep 4616</code></p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227234506.png" />
但是不对，猜测可能还有其他的修改时间行为，于是过滤一下有 Powershell 的。
<code>cat Security.evtx.log | grep 4616 -C 10 | grep powershell | wc</code></p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227234454.png" /></p>
<h2 id="task-11-what-is-the-sid-of-the-victim-user">Task 11 - What is the SID of the victim user?</h2>
<blockquote>
<p>S-1-5-21-3720869868-2926106253-3446724670-1003</p>
</blockquote>
<p>可以在 System event log 中找到</p>
<p><img alt="" src="../../../../assets/Pasted%20image%2020231227103905%201.png" /></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../Easy%29%20Logjammer/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Easy) Logjammer">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                Easy) Logjammer
              </div>
            </div>
          </a>
        
        
          
          <a href="../Very%20Easy%29%20BFT/" class="md-footer__link md-footer__link--next" aria-label="下一页: Very Easy) BFT">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Very Easy) BFT
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2018 - 2024 & Made by Fermionorz
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/4H7VVuW3" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/fermionorz" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:7tsl9ijac@mozmail.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.8l167.6-182.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.path", "navigation.prune", "navigation.top", "navigation.footer", "navigation.indexes", "header.autohide", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>